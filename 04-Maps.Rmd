

```{r, message=FALSE, warning=FALSE}

#None of this is useful yet. However, I will need to create a new variable in order to adjust this all. 

pal <- colorFactor("RdBu", metadataStateGIS$EstimatedProbability, reverse=TRUE)

leaflet(metadataGIS, options = leafletOptions(crsClass = "L.CRS.EPSG3857"), width="100%") %>%
  addPolygons(weight = 0.5, color = "gray", opacity = 0.7,
    fillColor = ~pal(EstimatedProbability), fillOpacity = 1, smoothFactor = 0.5,
    label = popupLabels,
    labelOptions = labelOptions(direction = "auto")) %>%
    addPolygons(data = stateGIS,fill = FALSE,color="black",weight = 1) %>%
    addLegend(pal = pal,values = ~metadataGIS$pctGOPcategories, opacity = 1, title = "% Trump",position = "bottomright")
``` 